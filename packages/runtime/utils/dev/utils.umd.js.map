{"version":3,"file":"utils.umd.js","sources":["../src/raw.ts","../src/utils.ts","../src/domApis.ts","../src/mimeType.ts"],"sourcesContent":["// 保存一些原始的属性\nexport const rawWindow = window;\nexport const rawDocument = document;\nexport const rawDocumentCtor = Document;\n\nexport const rawSetTimeout = rawWindow.setTimeout;\nexport const rawSetInterval = rawWindow.setInterval;\nexport const rawClearTimeout = rawWindow.clearTimeout;\nexport const rawClearInterval = rawWindow.clearInterval;\n\nexport const rawLocalstorage = rawWindow.localStorage;\nexport const rawSessionStorage = rawWindow.sessionStorage;\n\nexport const rawAddEventListener = window.addEventListener;\nexport const rawRemoveEventListener = window.removeEventListener;\n\nexport const rawMutationObserver = window.MutationObserver;\nexport const rawObserver = rawMutationObserver.prototype.observe;\n\nexport const rawAppendChild = HTMLElement.prototype.appendChild;\nexport const rawRemoveChild = HTMLElement.prototype.removeChild;\n\nexport const rawObject = Object;\nexport const rawObjectKeys = rawObject.keys;\nexport const rawObjectCreate = rawObject.create;\nexport const rawObjectDefineProperty = rawObject.defineProperty;\nexport const rawObjectGetOwnPropertyDescriptor =\n  rawObject.getOwnPropertyDescriptor;\n","export const noop = () => {};\n\nexport function createKey() {\n  return Math.random().toString(36).substr(2, 8);\n}\n\nexport function isObject(val: any) {\n  return val && typeof val === 'object';\n}\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nexport function hasOwn(obj: any, key: PropertyKey): boolean {\n  return hasOwnProperty.call(obj, key);\n}\n\nexport function def(obj: Object, key: string, value: any) {\n  Object.defineProperty(obj, key, {\n    get: () => value,\n    set: (val: any) => {\n      if (__DEV__) {\n        if (val !== value) {\n          error(`Try to modify a read-only property ${key}`);\n        }\n      }\n    },\n    // 测试环境允许 delete\n    configurable: __DEV__ ? true : false,\n  });\n}\n\n// 数组变为对象 `['a'] => { a: true }`\nexport function makeMap(list: Array<PropertyKey>) {\n  const map = Object.create(null);\n  for (let i = 0; i < list.length; i++) {\n    map[list[i]] = true;\n  }\n  return (val) => map[val] as boolean;\n}\n\nconst warnPrefix = '[Garfish warning]';\nconst processError = (\n  error: string | Error,\n  fn: (val: string | Error, isString: boolean) => void,\n) => {\n  if (typeof error === 'string') {\n    error = `${warnPrefix}: ${error}\\n\\n`;\n    fn(error, true);\n  } else if (error instanceof Error) {\n    if (!error.message.startsWith(warnPrefix)) {\n      error.message = `${warnPrefix}: ${error.message}`;\n    }\n    fn(error, false);\n  }\n};\n\nexport function warn(msg: string | Error) {\n  processError(msg, (e, isString) => {\n    const warnMsg = isString ? e : (e as Error).message;\n    if (__TEST__) {\n      const send = (warn as any)._onsend;\n      send && send(warnMsg);\n      return;\n    }\n    console.warn(warnMsg);\n  });\n}\n\nexport function error(error: string | Error) {\n  processError(error, (e, isString) => {\n    if (isString) {\n      throw new Error(e as string);\n    } else {\n      throw e;\n    }\n  });\n}\n\nexport function assert(condition: any, msg?: string | Error) {\n  if (!condition) {\n    error(msg || 'unknow reason');\n  }\n}\n\nexport function toBoolean(val: any) {\n  return val === 'false' ? false : Boolean(val);\n}\n\nexport function remove<T>(list: Array<T> | Set<T>, el: T) {\n  if (Array.isArray(list)) {\n    const i = list.indexOf(el);\n    if (i > -1) {\n      list.splice(i, 1);\n    }\n  } else {\n    if (list.has(el)) {\n      list.delete(el);\n    }\n  }\n}\n\n// 数组去重，不保证顺序\nexport function unique(arr: Array<any>) {\n  const res = [];\n  for (let i = 0, len = arr.length; i < len; i++) {\n    for (let j = i + 1; j < len; j++) {\n      if (arr[i] === arr[j]) {\n        j = ++i;\n      }\n    }\n    res.push(arr[i]);\n  }\n  return __TEST__ ? res.sort() : res;\n}\n\nexport function isPrimitive(val: any) {\n  return (\n    val === null ||\n    typeof val === 'string' ||\n    typeof val === 'number' ||\n    typeof val === 'symbol' ||\n    typeof val === 'boolean' ||\n    typeof val === 'undefined'\n  );\n}\n\n// 有些测试 jest.mock 不好测，可用这个工具方法\nexport function callTestCallback(obj: any, ...args: any[]) {\n  if (__TEST__) {\n    const oncalled = obj._oncalled;\n    if (typeof oncalled === 'function') {\n      oncalled.apply(null, args);\n    }\n  }\n}\n\n// 深度合并两个对象，能处理循环引用，后面的覆盖前面的，可选数组去重\nexport function deepMerge<K, T>(o: K, n: T, dp?: boolean): K & T {\n  const lRecord = new WeakMap();\n  const rRecord = new WeakMap();\n  const vRecord = new WeakMap();\n\n  const isArray = Array.isArray;\n  const isAllRefs = (a, b) => {\n    // 判断 merge 左右两边，不需要用到 vRecord\n    if (lRecord.has(a) || rRecord.has(a)) {\n      return lRecord.has(b) || rRecord.has(b);\n    }\n  };\n\n  const clone = (v) => {\n    // 深拷贝\n    if (isPrimitive(v) || typeof v === 'function') {\n      return v;\n    } else if (vRecord.has(v)) {\n      return vRecord.get(v);\n    } else if (lRecord.has(v)) {\n      return lRecord.get(v);\n    } else if (rRecord.has(v)) {\n      return rRecord.get(v);\n    } else if (isArray(v)) {\n      if (dp) v = unique(v);\n      const res = [];\n      vRecord.set(v, res);\n      for (let i = 0, len = v.length; i < len; i++) {\n        res[i] = clone(v[i]);\n      }\n      return res;\n    } else if (typeof v === 'object') {\n      const res = {};\n      vRecord.set(v, res);\n      const keys = Reflect.ownKeys(v);\n      keys.forEach((key) => (res[key] = clone(v[key])));\n      return res;\n    }\n  };\n\n  const setValue = (r, k) => {\n    if (r.has(k)) {\n      return r.get(k);\n    } else {\n      const val = clone(k);\n      if (!isPrimitive(val) && typeof val !== 'function') {\n        r.set(k, val);\n      }\n      return val;\n    }\n  };\n\n  const mergeObject = (l, r) => {\n    const res = {};\n    const lkeys = Reflect.ownKeys(l);\n    const rkeys = Reflect.ownKeys(r);\n\n    lRecord.set(l, res);\n    rRecord.set(r, res);\n\n    lkeys.forEach((key) => {\n      const lv = l[key];\n      const rv = r[key];\n\n      if (hasOwn(r, key)) {\n        if (isArray(lv) && isArray(rv)) {\n          const item = clone([].concat(lv, rv));\n          res[key] = dp ? unique(item) : item;\n        } else if (isObject(lv) && isObject(rv)) {\n          res[key] = isAllRefs(lv, rv) // 如果两变都是循环引用\n            ? lRecord.get(lv) // 左边右边同一个值，取哪个都行\n            : mergeObject(lv, rv);\n        } else {\n          res[key] = setValue(rRecord, rv);\n        }\n      } else {\n        res[key] = setValue(lRecord, lv);\n      }\n    });\n\n    rkeys.forEach((key) => {\n      if (hasOwn(res, key)) return;\n      res[key] = setValue(rRecord, r[key]);\n    });\n\n    return res;\n  };\n\n  return mergeObject(o, n) as any;\n}\n","import { makeMap } from './utils';\nimport { rawRemoveChild } from './raw';\n\nexport interface VText {\n  type: 'text' | 'comment';\n  content: string;\n}\n\nexport interface VNode {\n  key?: string;\n  type: 'element';\n  tagName: string;\n  children: Array<VNode | VText>;\n  attributes: Array<Record<string, string | null>>;\n}\n\nconst xChar = 120; // x\nconst colonChar = 58; // :\nconst ns = 'http://www.w3.org/2000/svg';\nconst xlinkNS = 'http://www.w3.org/1999/xlink'; // xmlns:xlink\nconst xmlNS = 'http://www.w3.org/XML/1998/namespace'; // xmlns\nconst MATCH_CSS_URL = /url\\(['\"]?([^\\)]+?)['\"]?\\)/g; // 匹配 css 中的 url\n\n// https://developer.mozilla.org/en-US/docs/Web/SVG/Element\nexport const SVG_TAGS =\n  'svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,' +\n  'defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,' +\n  'feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,' +\n  'feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,' +\n  'feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,' +\n  'fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,' +\n  'foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,' +\n  'mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,' +\n  'polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,' +\n  'text,textPath,title,tspan,unknown,use,view';\n\nexport const isSVG = makeMap(SVG_TAGS.split(','));\n\nfunction attributesString(attributes: VNode['attributes']) {\n  if (!attributes || attributes.length === 0) return '';\n  return attributes.reduce((total, { key, value }) => {\n    return total + (value ? `${key}=\"${value}\" ` : key);\n  }, '');\n}\n\nexport function applyAttributes(\n  el: Element,\n  attributes: Array<Record<string, string | null>>,\n) {\n  if (!attributes || attributes.length === 0) return;\n  for (const { key, value } of attributes) {\n    if (value === null) {\n      el.setAttribute(key, '');\n    }\n    // html entry 中只可能是 string\n    else if (typeof value === 'string') {\n      if (key.charCodeAt(0) !== xChar) {\n        el.setAttribute(key, value);\n      } else if (key.charCodeAt(3) === colonChar) {\n        el.setAttributeNS(xmlNS, key, value);\n      } else if (key.charCodeAt(5) === colonChar) {\n        el.setAttributeNS(xlinkNS, key, value);\n      } else {\n        el.setAttribute(key, value);\n      }\n    }\n  }\n}\n\nexport function isVText(vnode: VNode | VText) {\n  return vnode && vnode.type === 'text';\n}\n\nexport function isVNode(vnode: VNode | VText) {\n  return vnode && vnode.type === 'element';\n}\n\nexport function isComment(vnode: VNode | VText) {\n  return vnode && vnode.type === 'comment';\n}\n\nexport function isCssLink(vnode: VNode) {\n  if (!isVNode(vnode) || vnode.tagName !== 'link') return false;\n  return vnode.attributes.find(({ key, value }) => {\n    return key === 'rel' && value === 'stylesheet';\n  });\n}\n\nexport function isPrefetchJsLink(vnode: VNode) {\n  if (!isVNode(vnode) || vnode.tagName !== 'link') return false;\n  let hasRel, hasAs;\n  for (const { key, value } of vnode.attributes) {\n    if (key === 'rel') {\n      hasRel = true;\n      if (value !== 'preload' && value !== 'prefetch') {\n        return false;\n      }\n    } else if (key === 'as') {\n      hasAs = true;\n      if (value !== 'script') return false;\n    }\n  }\n  return (hasRel && hasAs) as boolean;\n}\n\nexport function removeElement(el: Element) {\n  const parentNode = el && el.parentNode;\n  if (parentNode) {\n    rawRemoveChild.call(parentNode, el);\n  }\n}\n\nexport function createElement(vnode: VNode) {\n  const { tagName, attributes } = vnode;\n  const el = isSVG(tagName)\n    ? document.createElementNS(ns, tagName)\n    : document.createElement(tagName);\n\n  applyAttributes(el, attributes);\n  return el;\n}\n\nexport function createTextNode(vnode: VText) {\n  return document.createTextNode(vnode.content);\n}\n\nexport function createLinkNode(vnode: VNode) {\n  const ps = attributesString(vnode.attributes);\n  return `<link ${ps.slice(0, -1)}></link>`;\n}\n\nexport function createStyleNode(content: string) {\n  const el = document.createElement('style');\n  content && (el.textContent = content);\n  applyAttributes(el, [{ key: 'type', value: 'text/css' }]);\n  return el;\n}\n\nexport function createScriptNode(vnode: VNode) {\n  const { attributes, children } = vnode;\n  const ps = attributesString(attributes);\n  const code = children?.[0] ? (children[0] as VText).content : '';\n  return document.createComment(\n    `<script ${ps} execute by garfish>${code}</script>`,\n  );\n}\n\n// Scheme: https://tools.ietf.org/html/rfc3986#section-3.1\n// Absolute URL: https://tools.ietf.org/html/rfc3986#section-4.3\nexport function isAbsolute(url: string) {\n  // `c:\\\\` 这种 case 返回 false，在浏览器中使用本地图片，应该用 file 协议\n  if (!/^[a-zA-Z]:\\\\/.test(url)) {\n    if (/^[a-zA-Z][a-zA-Z\\d+\\-.]*:/.test(url)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function transformUrl(resolvePath: string, curPath: string) {\n  const baseUrl = new URL(resolvePath, location.href);\n  const realPath = new URL(curPath, baseUrl.href);\n  return realPath.href;\n}\n\n// 暂时还不能处理 `@import 'a.css';`\nexport function transformCssUrl(resolvePath: string, code: string) {\n  if (!code) return '';\n  // 相对路径根据 css 文件的路径转换为绝对路径\n  return code.replace(MATCH_CSS_URL, (k1, k2) => {\n    if (isAbsolute(k2)) return k1;\n    return `url(\"${transformUrl(resolvePath, k2)}\")`;\n  });\n}\n\nexport function findProp(vnode: VNode, p: string) {\n  return vnode.attributes?.find(({ key }) => key === p);\n}\n","/* eslint-disable indent */\ntype FileType = ReturnType<typeof parseContentType>;\n\nexport function parseContentType(input: string) {\n  input = input?.trim();\n  if (!input) return null;\n\n  let idx = 0;\n  let type = '';\n  let subtype = '';\n  while (idx < input.length && input[idx] !== '/') {\n    type += input[idx];\n    idx++;\n  }\n  if (type.length === 0 || idx >= input.length) {\n    return null;\n  }\n\n  // 跳过 '/'\n  idx++;\n  while (idx < input.length && input[idx] !== ';') {\n    subtype += input[idx];\n    idx++;\n  }\n  subtype = subtype.replace(/[ \\t\\n\\r]+$/, '');\n  if (subtype.length === 0) return null;\n\n  return {\n    type: type.toLocaleLowerCase(),\n    subtype: subtype.toLocaleLowerCase(),\n  };\n}\n\nexport function isCss(ft: FileType) {\n  return ft ? ft.type === 'text' && ft.subtype === 'css' : false;\n}\n\nexport function isHtml(ft: FileType) {\n  return ft ? ft.type === 'text' && ft.subtype === 'html' : false;\n}\n\n// https://mimesniff.spec.whatwg.org/#javascript-mime-type\nexport function isJs(ft: FileType) {\n  const { type, subtype } = ft || {};\n  switch (type) {\n    case 'text': {\n      switch (subtype) {\n        case 'ecmascript':\n        case 'javascript':\n        case 'javascript1.0':\n        case 'javascript1.1':\n        case 'javascript1.2':\n        case 'javascript1.3':\n        case 'javascript1.4':\n        case 'javascript1.5':\n        case 'jscript':\n        case 'livescript':\n        case 'x-ecmascript':\n        case 'x-javascript': {\n          return true;\n        }\n        default: {\n          return false;\n        }\n      }\n    }\n    case 'application': {\n      switch (subtype) {\n        case 'ecmascript':\n        case 'javascript':\n        case 'x-ecmascript':\n        case 'x-javascript': {\n          return true;\n        }\n        default: {\n          return false;\n        }\n      }\n    }\n    default: {\n      return false;\n    }\n  }\n}\n"],"names":[],"mappings":"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"}