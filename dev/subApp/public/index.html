<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href=/asdf.png>
    <!-- <link rel="icon" href="<%= BASE_URL %>favicon.ico"> -->
    <!-- <link rel="stylesheet" href="<%= BASE_URL %>/css/xxx/xx.css"> -->
    <style>
      #MainApp {
        background-color: #5692ce;
      }
    </style>
    <script>
      // window.addEventListener('unhandledrejection', event => {
      //   event.promise.catch((e)=>{
      //   if (e instanceof Error) {
      //     console.log('vue app get error:', event); // 捕获后自定义处理
      //     throw e;
      //   }else {
      //     console.log(e);
      //   }
      // })
      //   console.log('vue app get error:', event);
      // }, true);
      // window.addEventListener('error', event => {
      //   console.log('vue app get error:', event); // 捕获后自定义处理
      // }, true);
    </script>
    <script>
      ;(function installSlardar(w, d, u, b, n, pc, ga, ae, po, s, p, e, t, pp) {pc = 'precollect';ga = 'getAttribute';ae = 'addEventListener';po = 'PerformanceObserver';s = function (m) {p = [].slice.call(arguments);p.push(Date.now(), location.href);(m == pc ? s.p.a : s.q).push(p)};s.q = [];s.p = { a: [] };w[n] = s;e = document.createElement('script');e.src = u + '?bid=' + b + '&globalName=' + n;e.crossorigin = u.indexOf('cdn') > 0 ? 'anonymous' : 'use-credentials';d.getElementsByTagName('head')[0].appendChild(e);if (ae in w) {s.pcErr = function (e) {e = e || w.event;t = e.target || e.srcElement;if (t instanceof Element || t instanceof HTMLElement) {if (t[ga]('integrity')) {w[n](pc, 'sri', t[ga]('href') || t[ga]('src'))} else {w[n](pc, 'st', { tagName: t.tagName, url: t[ga]('href') || t[ga]('src') })}} else {w[n](pc, 'err', e.error)}};s.pcRej = function (e) {e = e || w.event;w[n](pc, 'err', String(e.reason || (e.detail && e.detail.reason)))};w[ae]('error', s.pcErr, true);w[ae]('unhandledrejection', s.pcRej, true);};if('PerformanceLongTaskTiming' in w) {pp = s.pp = { entries: [] };pp.observer = new PerformanceObserver(function (l) {pp.entries = pp.entries.concat(l.getEntries)});pp.observer.observe({ entryTypes: ['longtask', 'largest-contentful-paint','layout-shift'] })}})(window,document,'https://lf3-short.bytegoofy.com/slardar/fe/sdk-web/browser.cn.js','1212','Slardar')
    </script>
    <script>
        // window.Slardar("init", {
        //   plugins: {
        //     sentry: {
        //           beforeSend: (event, hint) => {
        //             let sourceList = window.Garfishapps.react.vmSandbox.options.sourceList;
        //             if (event.level === 'error') {
        //               let frames = event.exception.values[0].stacktrace.frames;
        //               try {
        //                 for(let i = 0;i<frames.length;i++){
        //                   if (frames.filename.indexOf(sourceList)!==-1) {
        //                     console.log('^^^^^^^^^^^^^^^来自子应用 react',event);
        //                     return event;
        //                   }
        //                 }
        //               } catch(err){
        //                 return event;
        //               }
        //             } else {
        //               return event;
        //             }
        //           },
        //           // beforeBreadcrumb: (breadcrumb, hint) => breadcrumb,
        //       }
        //   }
        // });
        function computeStackTraceFromStackProp(ex) {
            if (!ex || !ex.stack) {
              return null;
            }

            const stack = [];
            const lines = ex.stack.split('\n');
            let isEval;
            let submatch;
            let parts;
            let element;

            for (let i = 0; i < lines.length; ++i) {
              if ((parts = chrome.exec(lines[i]))) {
                const isNative = parts[2] && parts[2].indexOf('native') === 0; // start of line
                isEval = parts[2] && parts[2].indexOf('eval') === 0; // start of line
                if (isEval && (submatch = chromeEval.exec(parts[2]))) {
                  // throw out eval line/column and use top-most line/column number
                  parts[2] = submatch[1]; // url
                }

                // Arpad: Working with the regexp above is super painful. it is quite a hack, but just stripping the `address at `
                // prefix here seems like the quickest solution for now.
                let url =
                  parts[2] && parts[2].indexOf('address at ') === 0
                    ? parts[2].substr('address at '.length)
                    : parts[2];

                // Kamil: One more hack won't hurt us right? Understanding and adding more rules on top of these regexps right now
                // would be way too time consuming. (TODO: Rewrite whole RegExp to be more readable)
                let func = parts[1] || UNKNOWN_FUNCTION;
                const isSafariExtension = func.indexOf('safari-extension') !== -1;
                const isSafariWebExtension = func.indexOf('safari-web-extension') !== -1;
                if (isSafariExtension || isSafariWebExtension) {
                  func = func.indexOf('@') !== -1 ? func.split('@')[0] : UNKNOWN_FUNCTION;
                  url = isSafariExtension
                    ? `safari-extension:${url}`
                    : `safari-web-extension:${url}`;
                }

                element = {
                  url,
                  func,
                  args: isNative ? [parts[2]] : [],
                  line: parts[3] ? +parts[3] : null,
                  column: parts[4] ? +parts[4] : null,
                };
              } else if ((parts = winjs.exec(lines[i]))) {
                element = {
                  url: parts[2],
                  func: parts[1] || UNKNOWN_FUNCTION,
                  args: [],
                  line: +parts[3],
                  column: parts[4] ? +parts[4] : null,
                };
              } else if ((parts = gecko.exec(lines[i]))) {
                isEval = parts[3] && parts[3].indexOf(' > eval') > -1;
                if (isEval && (submatch = geckoEval.exec(parts[3]))) {
                  // throw out eval line/column and use top-most line number
                  parts[1] = parts[1] || 'eval';
                  parts[3] = submatch[1];
                  parts[4] = submatch[2];
                  parts[5] = ''; // no column when eval
                } else if (i === 0 && !parts[5] && ex.columnNumber !== void 0) {
                  // FireFox uses this awesome columnNumber property for its top frame
                  // Also note, Firefox's column number is 0-based and everything else expects 1-based,
                  // so adding 1
                  // NOTE: this hack doesn't work if top-most frame is eval
                  stack[0].column = (ex.columnNumber) + 1;
                }
                element = {
                  url: parts[3],
                  func: parts[1] || UNKNOWN_FUNCTION,
                  args: parts[2] ? parts[2].split(',') : [],
                  line: parts[4] ? +parts[4] : null,
                  column: parts[5] ? +parts[5] : null,
                };
              } else {
                continue;
              }

              if (!element.func && element.line) {
                element.func = UNKNOWN_FUNCTION;
              }

              stack.push(element);
            }

            if (!stack.length) {
              return null;
            }

            return {
              message: extractMessage(ex),
              name: ex.name,
              stack,
            };
          }
        function computeErrorUrl(ex) {
          if (ex && ex.filename) return ex.filename;
          const res = computeStackTraceFromStackProp(ex);
          if (res) {
            const urls = res.stack.map((item) => {
              return item.url;
            });
            return urls;
          } else if (ex && ex.target && ex.target.tagName) {
            const tagName = ex.target.tagName.toLowerCase();
            if (sourceNode(tagName)) {
              return [ex.target.src || ex.target.href];
            }
          }
          return [];
        }
        browserClient('init', { bid: '121212' });
        browserClient('start');
        client('on', 'beforeSend', (ev) => {
          if (ev.ev_type === 'js_error') {
            console.log('#@@@@@@@@',ev,  computeErrorUrl(ev));
          }
          return ev;
        })
    </script>
    <!-- <script type="module">
      import a from 'http://localhost:9090/module.js';
    </script> -->
    <!-- <title><%= htmlWebpackPlugin.options.title %></title> -->
  </head>
  <script>
    // console.log(document.getElementById('subVue'), document.head, 'document.head');
  </script>
  <script>
    window.addEventListener('error',function (...args) {
      console.log('subApp: normal error',args)
    });

    window.addEventListener('unhandledrejection',function () {
      console.log('subApp: unhandledrejection error',args);
    });
  </script>
  <body>
    <noscript>
      <strong>We're sorry but <%= htmlWebpackPlugin.options.title %> doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    <div id="app"></div>
    <!-- <script>
      throw Error('normal err');
    </script> -->
    <script>
      // setTimeout(()=>{
      //   throw Error('subApp unhandledrejection error');
      // })
    </script>
    <!-- built files will be auto injected -->
    <!-- <img src="xxx" />
    <video src="1xxx" ></video> -->
    <div>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
        <g fill="none" fill-rule="evenodd">
            <path d="M0 0H20V20H0z"/>
            <path fill="currentColor" d="M10 .833c5.063 0 9.167 4.104 9.167 9.167S15.063 19.167 10 19.167.833 15.063.833 10 4.937.833 10 .833zM10 2.5c-4.142 0-7.5 3.358-7.5 7.5 0 4.142 3.358 7.5 7.5 7.5 4.142 0 7.5-3.358 7.5-7.5 0-4.142-3.358-7.5-7.5-7.5zM8.14 5.69l1.768 1.768 1.767-1.768c.163-.162.427-.162.59 0l.589.59c.163.162.163.426 0 .589l-2.068 2.067h2.13c.23 0 .417.187.417.417v.833c0 .23-.186.417-.416.417h-2.084v1.064h2.084c.23 0 .416.186.416.416v.834c0 .23-.186.416-.416.416h-2.084v1.25c0 .23-.186.417-.416.417h-.834c-.23 0-.416-.187-.416-.417v-1.25H7.083c-.23 0-.416-.186-.416-.416v-.834c0-.23.186-.416.416-.416h2.084v-1.064H7.083c-.23 0-.416-.187-.416-.417v-.833c0-.23.186-.417.416-.417h1.945l-.004-.005L6.96 6.87c-.162-.163-.162-.427 0-.59l.59-.589c.162-.162.426-.162.589 0z"/>
        </g>
      </svg>
    </div>
  </body>
  <script>
    // console.log('test', document.currentScript);
    // setTimeout(() => {
    //   console.log('test2', document.currentScript);
    // })
    // b = 2;
    // window.onload = function(e) {
    //   console.log('onload', e);
    // }
  //   window.onerror = function (...args) {
  //   console.log('vue app get error：', ...args);
  // }
  </script>
  <!-- <script src="<%= BASE_URL %>xxxasync.js" async></script> -->
</html>
